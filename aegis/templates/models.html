{% extends "base.html" %} {% block title %}Models - aegis{% endblock %} {% block
content %}
<div class="container py-5">
  <div class="row mb-4">
    <div class="col-12">
      <h2><i class="bi bi-cpu"></i> Model Registry</h2>
      <p class="text-muted">Manage your security analysis models</p>
    </div>
  </div>

  <ul class="nav nav-tabs mb-4" id="modelTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="ollama-tab"
        data-bs-toggle="tab"
        data-bs-target="#ollama"
        type="button"
        role="tab"
      >
        Ollama
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="cloud-tab"
        data-bs-toggle="tab"
        data-bs-target="#cloud"
        type="button"
        role="tab"
      >
        Cloud LLMs
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="hf-tab"
        data-bs-toggle="tab"
        data-bs-target="#hf"
        type="button"
        role="tab"
      >
        HuggingFace
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="classic-tab"
        data-bs-toggle="tab"
        data-bs-target="#classic"
        type="button"
        role="tab"
      >
        Classic ML
      </button>
    </li>
  </ul>

  <div class="tab-content" id="modelTabsContent">
    <!-- Ollama Tab -->
    <div class="tab-pane fade show active" id="ollama" role="tabpanel">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5>Ollama Models</h5>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#pullOllamaModal">
              <i class="bi bi-download"></i> Pull Model
            </button>
          </div>
          <div id="ollamaModelsList">
            <div class="text-center text-muted py-4">
              <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Cloud LLMs Tab -->
    <div class="tab-pane fade" id="cloud" role="tabpanel">
      <div class="card">
        <div class="card-body">
          <h5>Cloud LLM Providers</h5>
          <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addCloudModal">
            <i class="bi bi-plus-circle"></i> Add Cloud LLM
          </button>
          <div id="cloudModelsList"></div>
        </div>
      </div>
    </div>

    <!-- HuggingFace Tab -->
    <div class="tab-pane fade" id="hf" role="tabpanel">
      <div class="card">
        <div class="card-body">
          <h5>HuggingFace Models</h5>
          <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addHFModal">
            <i class="bi bi-plus-circle"></i> Add HF Model
          </button>
          <div id="hfModelsList"></div>
        </div>
      </div>
    </div>

    <!-- Classic ML Tab -->
    <div class="tab-pane fade" id="classic" role="tabpanel">
      <div class="card">
        <div class="card-body">
          <h5>Classic ML Models</h5>
          <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addClassicModal">
            <i class="bi bi-plus-circle"></i> Add Classic Model
          </button>
          <div id="classicModelsList"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Pull Ollama Model Modal -->
<div class="modal fade" id="pullOllamaModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Pull Ollama Model</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="pullOllamaForm">
          <div class="mb-3">
            <label for="ollamaModelName" class="form-label">Model Name</label>
            <input type="text" class="form-control" id="ollamaModelName" placeholder="e.g., qwen2.5-coder:7b" required>
          </div>
        </form>
        <div id="pullProgress" style="display: none;">
          <div class="progress mt-3">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%">
              Pulling model...
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="pullOllamaModel()">Pull</button>
      </div>
    </div>
  </div>
</div>

<!-- Add Cloud LLM Modal -->
<div class="modal fade" id="addCloudModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Cloud LLM</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="addCloudForm">
          <div class="mb-3">
            <label for="cloudProvider" class="form-label">Provider</label>
            <select class="form-select" id="cloudProvider" required>
              <option value="openai">OpenAI</option>
              <option value="anthropic">Anthropic</option>
              <option value="azure">Azure OpenAI</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="cloudModelName" class="form-label">Model Name</label>
            <input type="text" class="form-control" id="cloudModelName" placeholder="e.g., gpt-4o" required>
          </div>
          <div class="mb-3">
            <label for="cloudApiKey" class="form-label">API Key</label>
            <input type="password" class="form-control" id="cloudApiKey" required>
          </div>
          <div class="mb-3">
            <label for="cloudApiBase" class="form-label">API Base URL (optional)</label>
            <input type="text" class="form-control" id="cloudApiBase" placeholder="Leave empty for default">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="addCloudModel()">Add</button>
      </div>
    </div>
  </div>
</div>

<!-- Add HF Model Modal -->
<div class="modal fade" id="addHFModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add HuggingFace Model</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="addHFForm">
          <div class="mb-3">
            <label for="hfModelId" class="form-label">Model ID</label>
            <input type="text" class="form-control" id="hfModelId" placeholder="e.g., bigcode/starcoder2" required>
          </div>
          <div class="mb-3">
            <label for="hfTask" class="form-label">Task</label>
            <select class="form-select" id="hfTask">
              <option value="text-generation">Text Generation</option>
              <option value="sequence-classification">Sequence Classification</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="hfCacheDir" class="form-label">Cache Directory (optional)</label>
            <input type="text" class="form-control" id="hfCacheDir">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="addHFModel()">Add</button>
      </div>
    </div>
  </div>
</div>

<!-- Add Classic Model Modal -->
<div class="modal fade" id="addClassicModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Classic ML Model</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="addClassicForm">
          <div class="mb-3">
            <label for="classicModelPath" class="form-label">Model Path</label>
            <input type="text" class="form-control" id="classicModelPath" placeholder="/path/to/model.pkl" required>
          </div>
          <div class="mb-3">
            <label for="classicModelType" class="form-label">Model Type</label>
            <select class="form-select" id="classicModelType">
              <option value="sklearn">scikit-learn</option>
              <option value="onnx">ONNX</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="addClassicModel()">Add</button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/models.js') }}"></script>
{% endblock %}

